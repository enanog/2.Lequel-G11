# EDA #level2: Lequel?

## Integrantes del grupo y contribución al trabajo de cada integrante
* Micaela Dinsen: optimizaciones de rendimiento, mejoras en precisión de detección, documentación del código.
* Dylan Frigerio: implementación inicial, pruebas de precisión, documentación del código.


## Respuestas del enunciado

1. ¿En qué idioma está el siguiente texto?

історія земель сучасної України, українського народу та інших національностей, що проживають на території України, від доісторичних часів до сьогодення.

En ucraniano.

2. ¿En qué idioma está el siguiente texto?

아리랑, 아리랑, 아라리요... 아리랑 고개로 넘어간다. 나를 버리고 가시는 님은 십리도 못가서 발병난다. 청천하늘엔 잔별도 많고, 우리네 가슴엔 희망도 많다. 저기 저 산이 백두산이라지, 동지 섣달에도 꽃만 핀다.

En coreano.

3. ¿En qué idioma está el siguiente texto?

၁၉၄၀ ခုနှစ်တွင် ဗိုလ်ချုပ်အောင်ဆန်းဦးဆောင်သည့် ရဲဘော်သုံးကျိပ်အဖွဲ့ဝင်တို့သည် ဗမာ့လွတ်မြောက်ရေးတပ်မတော် (ဘီအိုင်အေ) ကို တည်ထောင်ခဲ့ကြသည်။[၂၀][၂၀] ရဲဘော်သုံးကျိပ်သည် ဂျပန်နိုင်ငံတွင် စစ်သင်တန်းများတက်ရောက်ခဲ့ကြသည်။[၂၀]

En birmano.

4. ¿En qué idioma está el siguiente texto?

Negema wangu binti, mchachefu wa sanati upulike wasiati asa ukanzingatia. Maradhi yamenshika hatta yametimu mwaka sikupata kutamka neno lema kukwambia. Ndoo mbee ujilisi na wino na qaratasi moyoni nina hadithi nimependa kukwambia.

En suajili.

5. ¿En qué idioma está el siguiente texto?

Այժմ նա յուր կինտոյի արհեստով ժառանգած Ճանճուր մականունը կցելով յուր հոր՝ Օհանեսի անվան հետ, կոչվում է «Թիֆլիսի պատվավոր քաղաքացի Ճանճուր Իվանիչ»։ Այդ անունով ևս մենք պարտավորվում ենք նրան ծանոթացնել մեր ընթերցողներին։

En armenio.

6. ¿En qué idioma está el siguiente texto?

Belirli bir bölgedeki mevcut hava durumu hava raporu, gelecekte beklenen durumlar ise hava tahmini şeklinde, ilgili meteoroloji otoriteleri tarafından yayımlanır.

En turco.

7. ¿En qué idioma está el siguiente texto?

ᎤᎵᏍᏔᏴᏗ ᎦᎵᏙᏗ ᏭᎷᏤᎢ, ᎤᏗᏔᎮ ᎦᏁᎲ, ᎤᏲᏏᏍᎩ ᎤᏗᏔᎮ ᎤᏅᏗ ᏃᎴ ᎤᎩᏍᏙᎡ ᏑᎾᎴ ᎠᎩᏍᏗ ᎤᏂᏑᎸᏓ. ᎣᏍᏓ ᏄᎵᏍᏔᏁᎮ ᎤᏩᏌ ᎤᏪᏅᏒ ᎡᏙᎲ. ᎦᏅᏆᎶᏍᏗ ᏭᏴᎮ ᏣᏄᏏ ᏃᎴ ᏣᏁᎳ ᎠᏂᏎᏂᏏ ᏴᎩ, ᎣᏍᏓ ᏄᏩᏁᎴ ᎠᏦᏴ.

En cheroqui.

8. ¿En qué idioma está el siguiente texto?

ُیعتقد بأن ضابطة في الجیش البریطاني تدعى بریت تشاندي أصبحت أولامرأة من أصول آسیویة ُتكملُ رحلة استكشافیة فردیة عبر .القارة القطبیة الجنوبی  

En árabe.

9. ¿En qué idioma está el siguiente texto?

ગુજરાતી સંસ્કૃત ભાષામાંથી વિકસિત થયેલી આધુનિક ઈન્ડો-આર્યન ભાષા છે. પરંપરાગત રીતે ૩ ઐતિહાસિક તબક્કાઓ પ્રમાણે ઈન્ડો-આર્યન ભાષાઓ વચ્ચે ભેદ કરાય છે.

En guyaratí.

10. ¿En qué idioma está el siguiente texto?

Al Seicento appartiene il primo trattato dedicato non ai volgari italiani o a uno o più di tali volgari, ma alla lingua italiana in quanto tale: Delle osservazioni della lingua italiana di Marcantonio Mambelli, detto il Cinonio.

En italiano.

11. El siguiente texto fue escrito por Robert Burns en escocés. ¿Qué dice Lequel? ¿Qué falla? Justifica por qué ocurre lo que ocurre.

And there's a hand, my trusty fiere! and gie's a hand o' thine! And we’ll tak' a right gude-willie waught, for auld lang syne.

Lequel dice inglés, falla porque el escocés y el inglés son idiomas germánicos extremadamente parecidos y comparten una gran cantidad de vocabulario y estructura. La mayoría de las palabras y, por lo tanto, de los trigramas, son idénticos o muy similares a los del inglés ("And", "the", " a ", "han", " my", "for"). El perfil de trigramas generado para este texto tiene una similitud de coseno altísima con el perfil del inglés. 

12. El siguiente texto está en inglés. ¿Qué dice Lequel? ¿Qué falla? Justifica por qué ocurre lo que ocurre.

IT WAS THE BEST OF TIMES, IT WAS THE WORST OF TIMES,
IT WAS THE AGE OF WISDOM, IT WAS THE AGE OF FOOLISHNESS,
IT WAS THE EPOCH OF BELIEF, IT WAS THE EPOCH OF INCREDULITY,
IT WAS THE SEASON OF LIGHT, IT WAS THE SEASON OF DARKNESS,
IT WAS THE SPRING OF HOPE, IT WAS THE WINTER OF DESPAIR,
WE HAD EVERYTHING BEFORE US, WE HAD NOTHING BEFORE US,
WE WERE ALL GOING DIRECT TO HEAVEN, WE WERE ALL GOING DIRECT THE OTHER WAY
– IN SHORT, THE PERIOD WAS SO FAR LIKE THE PRESENT PERIOD, THAT SOME OF ITS NOISIEST AUTHORITIES INSISTED ON ITS BEING RECEIVED, FOR GOOD OR FOR EVIL, IN THE SUPERLATIVE DEGREE OF COMPARISON ONLY.

Lequel dice que está en "desconocido", debido a que el perfil de idioma para el inglés que Lequel tiene almacenado fue creado a partir de textos normales, que están mayormente en minúsculas. El perfil de referencia del inglés contiene trigramas como "the", " was", " of", "tim", y el perfil generado a partir del texto de entrada contiene trigramas completamente diferentes: "THE", " WAS", " OF", "TIM". Para la computadora, "the" y "THE" son dos secuencias de bytes totalmente distintas. Como resultado, hay casi cero coincidencias entre los trigramas del texto de entrada y los del perfil de inglés. La similitud de coseno calculada es extremadamente baja, cayendo por debajo del umbral de confianza (SIMILARITY_THRESHOLD). Por lo tanto, el programa concluye que no puede identificar el idioma con certeza y devuelve "desconocido".

## Bonus points
## Cambios y Optimizaciones Realizadas

### 1. Sustitución de estructuras de datos
- **`map` → `unordered_map`**  
  - Se reemplazó `map` por `unordered_map` en la representación de perfiles de trigramas.  
  - Razón: `unordered_map` utiliza *hashing* en lugar de un árbol balanceado, lo que permite **acceso y actualizaciones promedio en O(1)**, mejorando la velocidad en comparación con O(log n) de `map`.  
  - Este cambio es crítico porque el número de trigramas distintos puede ser muy grande.

- **`list` → `vector`**  
  - En la representación de textos (`Text`) y otras estructuras internas se reemplazó `list` por `vector`.  
  - Razón: los accesos secuenciales y aleatorios son más rápidos en `vector`, debido a la memoria contigua en RAM.  
  - Además, `vector` reduce la sobrecarga de punteros que sí tienen las listas enlazadas.  
  - Este cambio resulta más eficiente para recorrer líneas y trigramas.

---

### 2. Representación de trigramas con `uint64_t`
- Los trigramas ya no se almacenan como cadenas (`string`), sino como **enteros de 64 bits (`uint64_t`)**.  
- Cada trigrama (3 caracteres Unicode en UTF-16) se empaqueta en un solo `uint64_t`.  
  - Ejemplo:  
    - Primer carácter → bits 32–47  
    - Segundo carácter → bits 16–31  
    - Tercer carácter → bits 0–15  
- **Ventajas**:
  - Comparaciones y *hashing* mucho más rápidas que con `string`.  
  - Reducción significativa en el uso de memoria.  
  - Mejor rendimiento en búsquedas dentro de `unordered_map`.

---

### 3. Optimización de memoria
- Se agregó un **`reserve()`** inicial al crear perfiles de trigramas.  
- Esto previene múltiples **realocaciones dinámicas** a medida que se insertan nuevos elementos.  
- Resultado:  
  - Menor fragmentación de memoria.  
  - Mayor rendimiento en la construcción de perfiles de trigramas grandes.

---

### 4. Medición de tiempos con `<chrono>`
- Se incorporó la librería estándar **`<chrono>`** para medir el tiempo de ejecución.  
- Ahora se puede conocer cuánto tarda el análisis de un texto en identificarse.  
- Esto permite evaluar el rendimiento y comparar mejoras entre implementaciones.  
- El tiempo se muestra tanto en **milisegundos** como en **segundos** (si supera 1000 ms).

---

## 📂 Cambios en archivos
- **`Lequel.h / Lequel.cpp`**  
  - Trigramas almacenados como `uint64_t` en lugar de `string`.  
  - Se reemplazó `map` por `unordered_map`.  
  - Se añadió `reserve()` en la creación de perfiles.  

- **`Text.h / Text.cpp`**  
  - Tipo `Text` pasó de `list<string>` a `vector<string>`.  
  - Mejor desempeño en lectura y procesamiento de archivos.  

- **`main.cpp`**  
  - Incorporación de la librería `<chrono>` para medir el tiempo de ejecución.  
  - Ajustes en el flujo de procesamiento para mostrar el tiempo junto al resultado de identificación.
